### 3.5.2 递归

#### 一、递归的概念和分类

递归：方法自己调用自己。
 分类：直接递归和间接递归。
   直接递归是方法自身调用自己。
   间接递归可以A方法调用B方法，B方法调用C方法，C方法调用A方法。
 注意事项：
   1、递归一定要有条件限定，保证递归能够停下来，否则会发生栈内存溢出。

​                                
   2、在递归中虽然有条件限定，但是递归次数不能太多，否则会发生栈内存溢出。

```
private static void b(int i) {
    System.out.println(i);
    if (i == 20000) {
        return;
    }
    b(++i);  //10985  Exception in thread "main" java.lang.StackOverflowError
}
```

3、构造方法禁止调用递归。

```
public Demo01Recursion(){
    //Demo01Recursion();//编译报错：构造方法是创建对象用的，一直递归会导致内存中有无数多个对象，所以直接编译报错。
}
```


 使用前提：
 当调用方法的时候，方法的主体不变，每次调用方法的参数不同，可以使用递归。

 

#### 二、练习

**1.****计算1-n****之间的和。**

思路：1+2+....+n，也就是n+(n-1)+(n-2)+...+2+1
 已知最大值n，最小值1
 使用递归必须明确：
   1、递归的结束条件 获取到1的时候结束
   2、递归的目的：获取下一个要加的数字（n-1）

```
public static void main(String[] args) {
    int result = sum(100);
    System.out.println(result);
}
public static int sum(int n) {
    //获取到1时结束
    if (n == 1) {
        return 1;
    }
    //获取下一个要加的数字（n-1）
    return n + sum(n - 1);
}
```

注意：使用递归求和，main方法会调用sum方法，sum方法会一直调用sum方法，导致在内存中有多个sum方法，频繁地创建方法、调用方法、销毁方法，效率低下。

所以如果仅仅是计算1-n之间的和，不推荐使用递归，直接使用for循环即可。

 

**2.****使用递归计算阶乘。**

**（方法主体不变，参数发生变化）**

```
public static int multi(int n){
    //递归的结束条件
    if(n==1){
        return 1;
    }
    //递归的目的：获取下一个被乘的数字n-1
    return n*(multi(n-1));
}
```

 

**3.** **使用递归打印多级目录**
 思路：定义一个方法，参数传递File类型的目录。
    方法中对目录进行遍历

```
/*
 发现直接遍历的结果并不完全，只有文件夹下的内容，没有子文件夹下的内容。
 解决：对遍历得到的file对象进行判断是否是文件夹，是则继续调用getAllFiles
*/
public static void getAllFiles(File dir) {

    System.out.println(dir);
    File[] files = dir.listFiles();
    for (File file : files) {
        if (file.isDirectory()) {  //如果是文件夹，则继续遍历
            getAllFiles(file);
        } else {
            System.out.println(file); //否则直接打印文件
        }

    }
}
```

 

4.使用递归进行文件搜索

```
for (File file : files) {
    if (file.isDirectory()) {  //如果是文件夹，则继续遍历
        getAllFiles(file);
    } else {//文件中所有大写或小写以.java结束的打印输出
        /*判断以.java结尾
        file.getPath();
        file.toString();
        file.getName();*/
        if(file.getName().toLowerCase().endsWith(".java")){
            System.out.println(file);
        }
    }
}
```

 